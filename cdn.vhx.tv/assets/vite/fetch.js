const d=t=>t.urls.api_v1;function p(){return Promise.resolve({api:{token:window.VHX.config.token},urls:{api_v1:window.VHX.config.api_url}})}async function o(t,n={}){const{method:s,data:u}=n,e=await p(),r=/^https?:\/\//.test(t)?t:`${d(e)}${t}`,f=await fetch(r,{method:s||"GET",headers:l(e),credentials:"include",body:JSON.stringify(u)});return await c(f)}function m(t,n={}){return o(`/admin${t}`,n)}function w(t,n={}){return o(`/ott_staff${t}`,n)}const l=t=>({Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t.api.token}`}),i=document.querySelector("meta[name=csrf-token]"),a={"X-Requested-With":"XMLHttpRequest","X-CSRF-Token":i.content,"Content-Type":"application/json"},T=t=>{i.content=t,a["X-CSRF-Token"]=t},g=async()=>{const t=await fetch("/admin/tokens/",{method:"POST",headers:a}),n=await c(t);n.token&&(window.VHX.config.token=n.token)},h=async t=>{try{return await t.json()}catch{return{message:t!=null&&t.ok?"success":"error"}}},c=async t=>{try{const n=await h(t);return t!=null&&t.ok?Promise.resolve(n):Promise.reject({status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,message:n==null?void 0:n.message})}catch{return Promise.reject({status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText})}},j=(t={})=>Object.keys(t).map(n=>{if(t[n]||t[n]===!1||t[n]===0)return typeof t[n]=="object"?`${n}=${encodeURIComponent(JSON.stringify(t[n]))}`:`${n}=${encodeURIComponent(t[n])}`}).filter(n=>!!n).join("&");export{m as a,o as b,T as c,g as d,l as f,a as i,j,c as r,w as s};
//# sourceMappingURL=fetch.4b32cb52.js.map
